!function(e,s,o){var c="ResourceLoader";"object"==typeof exports&&"object"==typeof module?module.exports=o(s):"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports[c]=o(s):e[c]=o(s)}(this,window,function(e){"use strict";var s=function(e){this.configs=e,this.resources=[],this.finished=0};return s.prototype._loadImg=function(e){var s=this;$('<img src="'+e.src+'">').on("load",function(){s.finished++,s.onResourceReady(e,this,!0),e.success&&e.success(e)}).on("error",function(o){s.finished++,s.onResourceReady(e,this,!1,o)})},s.prototype.load=function(){var e=this,s=function(s,o){var c=setInterval(function(){try{100==s.PercentLoaded()&&(clearInterval(c),e.finished++,e.onResourceReady(o,s,!0),o.success&&o.success(o,s))}catch(n){console.log(n),clearInterval(c),e.finished++,e.onResourceReady(o,s,!0),o.success&&o.success(o,s)}},300);setTimeout(function(){clearInterval(c),e.finished++,e.onResourceReady(o,s,!1)},5e3)};$.each(this.configs,function(o,c){switch(c.type){case"swf":e.resources.push(c),require.ensure(["swfobject-amd"],function(){require("swfobject-amd").embedSWF(c.src,c.target,"100%","100%","10",void 0,void 0,{wmode:"opaque",allowfullscreen:!1},void 0,function(o){o.success?s(o.ref,c):(e.finished++,e.onResourceReady(c,null,!1))})});break;case"img":e.resources.push(c),e._loadImg(c);break;case"style":for(var n=[],r=/url\("([^"]*)"\)/g,t=[];n=r.exec(c.content);)t.push(n[1]);$.unique(t),$.each(t,function(s,o){var n={type:"img",src:o,success:function(){t.splice(o,1),0==t.length&&c.success&&c.success(c,null,!0)}};e.resources.push(n),e._loadImg(n)});break;case"video":e.resources.push(c),$(c.elem).one("canplaythrough",function(){e.finished++,e.onResourceReady(c,this,!0),c.success&&c.success(c)});break;case"deferred":e.resources.push(c),c.defer.done(function(){e.finished++,e.onResourceReady(c,this,!0)})}})},s.prototype.onResourceReady=function(e,s,o){},s});